<div class="breadcrumb">
    <h1>Comp√©tences</h1>
    <ul>
        <li><a href="">Gestion des Comp√©tences</a></li>
        <li>Comp√©tences</li>
    </ul>
</div>

<div class="separator-breadcrumb border-top"></div>

<!-- ADD BUTTON -->
<div class="row mb-3">
    <div class="col-md-12">
        <button class="btn btn-primary float-right" (click)="exportCompetences()">
            üì§ Export Comp√©tences
          </button>
    </div>
</div>

<!-- COMPETENCE TABLE -->
<div class="row">
    <div class="col-md-12">
        <div class="card o-hidden">
            <ngx-datatable *ngIf="competences?.length > 0" 
                class="material fullscreen"
                [style.height]="60*competences.length+60+'px'"
                [columnMode]="'force'"
                [headerHeight]="50"
                [footerHeight]="0"
                [rowHeight]="60"
                [scrollbarV]="true"
                [scrollbarH]="true"
                [rows]="competences">
                
                <!-- Code Column -->
                <ngx-datatable-column name="Code" prop="code">
                    <ng-template ngx-datatable-header-template>Code</ng-template>
                    <ng-template ngx-datatable-cell-template let-row="row">{{ row.code }}</ng-template>
                </ngx-datatable-column>

                <!-- Description Column -->
                <ngx-datatable-column name="Description" prop="description">
                    <ng-template ngx-datatable-header-template>designation</ng-template>
                    <ng-template ngx-datatable-cell-template let-row="row">
                        {{ row.designation || 'Aucune description' }}
                    </ng-template>
                </ngx-datatable-column>

                <!-- Observation Column -->
                <ngx-datatable-column name="Observation" prop="observation">
                    <ng-template ngx-datatable-header-template>Observation</ng-template>
                    <ng-template ngx-datatable-cell-template let-row="row">
                        {{ row.observatin || 'N/A' }}
                    </ng-template>
                </ngx-datatable-column>

                <!-- Actions Column -->
                <ngx-datatable-column name="Actions" [width]="200">
                    <ng-template ngx-datatable-header-template>Actions</ng-template>
                    <ng-template ngx-datatable-cell-template let-row="row">
                        <button class="btn btn-outline-warning m-1" (click)="editCompetence(row.id)">‚úèÔ∏è Modifier</button>
                        <button class="btn btn-outline-danger m-1" (click)="openDeleteModal(row.id, modalConfirm)">
                            üóëÔ∏è Supprimer
                        </button>
                    </ng-template>
                </ngx-datatable-column>
            </ngx-datatable>
        </div>

        <!-- Show message when no data -->
        <div *ngIf="competences?.length === 0" class="text-center p-4">
            <p class="text-muted">‚ö†Ô∏è Aucune comp√©tence trouv√©e.</p>
        </div>
    </div>
</div>

<!-- DELETE CONFIRMATION MODAL -->
<ng-template #modalConfirm let-modal>
  <div class="modal-header">
    <h4 class="modal-title">‚ö†Ô∏è Confirmation</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('cancel')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <p>√ätes-vous s√ªr de vouloir supprimer cette comp√©tence ? Cette action est irr√©versible.</p>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-secondary" (click)="modal.dismiss('cancel')">Annuler</button>
    <button type="button" class="btn btn-danger" (click)="confirmDelete(modal)">Supprimer</button>
  </div>
</ng-template>
